<!DOCTYPE html>
<html lang="en">
<head>
<title>Record the audio</title>
</head>
<body>
<script>
    function recordAudio(step, duration) {
        var xhr = new XMLHttpRequest();
        xhr.open('POST', '{{ url_for("record_audio") }}', true);
        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4 && xhr.status == 200) {
                var button = event.target;
                button.innerHTML = 'Done';
                button.style.backgroundColor = '#ddd'; // Gray color for done
                button.className = 'done';
                button.disabled = true;

                // Allow re-recording for the same step if needed
                setTimeout(function () {
                    button.innerHTML = 'Record';
                    button.style.backgroundColor = '#4caf50'; // Green color for record
                    button.className = '';
                    button.disabled = false;
                }, 1000);
            }
        };
        xhr.send('audio_step=' + step);

        // Change the button style to indicate recording
        var button = event.target;
        button.innerHTML = 'Recording...';
        button.style.backgroundColor = '#ff0000'; // Red color for recording
        button.disabled = true;

        // Simulate recording duration
        setTimeout(function () {
            button.innerHTML = 'Done';
            button.style.backgroundColor = '#ddd'; // Gray color for done
            button.className = 'done';
            button.disabled = true;

            // Allow re-recording for the same step if needed
            setTimeout(function () {
                button.innerHTML = 'Record';
                button.style.backgroundColor = '#4caf50'; // Green color for record
                button.className = '';
                button.disabled = false;
            }, 1000);
        }, duration * 1000); // Convert seconds to milliseconds
    }
</script>
</body>
</html>